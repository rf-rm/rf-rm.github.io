



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
        <meta name="author" content="rf-rm Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>3.HA Proxy OPS - rf-rm Command</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/application.11e41852.css">
      
      
    
    
      <script src="../../../../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../../assets/fonts/material-icons.css">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#ha_-_proxy_va_keep_alived_tren_cac_openstack_instance" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../.." title="rf-rm Command" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                rf-rm Command
              </span>
              <span class="md-header-nav__topic">
                3.HA Proxy OPS
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../.." title="rf-rm Command" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    rf-rm Command
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../.." title="Remove Everything with `rm-rf /`" class="md-nav__link">
      Remove Everything with `rm-rf /`
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Openstack Research
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Openstack Research
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../1. Intro Cloud Computing/" title="Cloud Computing and Openstack" class="md-nav__link">
      Cloud Computing and Openstack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../2.install-pack-stack/" title="2.install pack stack" class="md-nav__link">
      2.install pack stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Readme/" title="Readme" class="md-nav__link">
      Readme
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Advance
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="5">
      <label class="md-nav__title" for="nav-2-4">
        Advance
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/1. Key-Rotate-&-Decrypt/" title="Fernet và Rotate trong OPS" class="md-nav__link">
      Fernet và Rotate trong OPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/10. Limit-CPU-Resource/" title="10. Limit CPU Resource" class="md-nav__link">
      10. Limit CPU Resource
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/11. Metadata/" title="11. Metadata" class="md-nav__link">
      11. Metadata
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/12. Cloud-init/" title="12. Cloud init" class="md-nav__link">
      12. Cloud init
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/13. Cloud-init-Script/" title="13. Cloud init Script" class="md-nav__link">
      13. Cloud init Script
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/14. QOS - Neutron/" title="14. QOS   Neutron" class="md-nav__link">
      14. QOS   Neutron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/15. QOS - Cinder/" title="15. QOS   Cinder" class="md-nav__link">
      15. QOS   Cinder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/16. Cinder-Backup-NFS/" title="16. Cinder Backup NFS" class="md-nav__link">
      16. Cinder Backup NFS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/17. Transfer-&-Extend-Root-Volume/" title="17. Transfer & Extend Root Volume" class="md-nav__link">
      17. Transfer & Extend Root Volume
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/18. L3-Agent-HA-Compute/" title="18. L3 Agent HA Compute" class="md-nav__link">
      18. L3 Agent HA Compute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/2.RabbitMQ-&-API-Endpoint/" title="2.RabbitMQ & API Endpoint" class="md-nav__link">
      2.RabbitMQ & API Endpoint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/3. Log/" title="3. Log" class="md-nav__link">
      3. Log
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/4. Setup-noVNC/" title="noVNC trong OPS" class="md-nav__link">
      noVNC trong OPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/5. Nova-Compute-Serice-&-RabbitMQ/" title="5. Nova Compute Serice & RabbitMQ" class="md-nav__link">
      5. Nova Compute Serice & RabbitMQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/6. Placement-API-&-Nova-Conductor/" title="6. Placement API & Nova Conductor" class="md-nav__link">
      6. Placement API & Nova Conductor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/7.1.  Resource-Management-OPS/" title="Resource Management trong OPS" class="md-nav__link">
      Resource Management trong OPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/7.2 . Nova-Scheduler-&-Host-Aggreaggregate/" title="1. Nova-scheduler" class="md-nav__link">
      1. Nova-scheduler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/7.3. Lab-Filter-Scheduler/" title="7.3. Lab Filter Scheduler" class="md-nav__link">
      7.3. Lab Filter Scheduler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/8. Resize-instance/" title="8. Resize instance" class="md-nav__link">
      8. Resize instance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Advance/9. Rescue-instance/" title="1. Nova-rescue" class="md-nav__link">
      1. Nova-rescue
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      Barbican
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="6">
      <label class="md-nav__title" for="nav-2-5">
        Barbican
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Barbican/1. Intro-Setup/" title="1. Intro Setup" class="md-nav__link">
      1. Intro Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Barbican/2. Command/" title="2. Command" class="md-nav__link">
      2. Command
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Cinder
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="7">
      <label class="md-nav__title" for="nav-2-6">
        Cinder
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Cinder/1. Introduction-cinder/" title="OpenStack Block Storage - Cinder" class="md-nav__link">
      OpenStack Block Storage - Cinder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Cinder/2. Cinder-Disk-Work-Flow/" title="2. Cinder Disk Work Flow" class="md-nav__link">
      2. Cinder Disk Work Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Cinder/3. Install-Cinder-LVM/" title="3. Install Cinder LVM" class="md-nav__link">
      3. Install Cinder LVM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Cinder/4. Basic-Command/" title="4. Basic Command" class="md-nav__link">
      4. Basic Command
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Cinder/5. Install-Multi-Backend/" title="5. Install Multi Backend" class="md-nav__link">
      5. Install Multi Backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Cinder/6. Filtering-Multi-Backend/" title="6. Filtering Multi Backend" class="md-nav__link">
      6. Filtering Multi Backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Cinder/7. Cinder-More/" title="7. Cinder More" class="md-nav__link">
      7. Cinder More
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Glance
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="8">
      <label class="md-nav__title" for="nav-2-7">
        Glance
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Glance/1. Introduction-Glance/" title="OPENSTACK IMAGE - GLANCE" class="md-nav__link">
      OPENSTACK IMAGE - GLANCE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Glance/2. Install Glance/" title="Cài đặt Glance - Openstack IMAGE" class="md-nav__link">
      Cài đặt Glance - Openstack IMAGE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Glance/3. Openstack-Glance-&-CURL/" title="Làm việc với Glance" class="md-nav__link">
      Làm việc với Glance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Glance/4. Config/" title="Tìm hiểu cấu hình cơ bản trong Glance" class="md-nav__link">
      Tìm hiểu cấu hình cơ bản trong Glance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Glance/5. Glance-Advanced/" title="5. Glance Advanced" class="md-nav__link">
      5. Glance Advanced
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-8" type="checkbox" id="nav-2-8" checked>
    
    <label class="md-nav__link" for="nav-2-8">
      High availability
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="9">
      <label class="md-nav__title" for="nav-2-8">
        High availability
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../1. Introduction-HA/" title="1. Introduction HA" class="md-nav__link">
      1. Introduction HA
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-8-2" type="checkbox" id="nav-2-8-2" checked>
    
    <label class="md-nav__link" for="nav-2-8-2">
      1.HA Proxy   KeepAlive
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="11">
      <label class="md-nav__title" for="nav-2-8-2">
        1.HA Proxy   KeepAlive
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../1.Intro/" title="1.Intro" class="md-nav__link">
      1.Intro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2. Setup-HA-Proxy-&&-KeepAlive/" title="2. Setup HA Proxy && KeepAlive" class="md-nav__link">
      2. Setup HA Proxy && KeepAlive
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        3.HA Proxy OPS
      </label>
    
    <a href="./" title="3.HA Proxy OPS" class="md-nav__link md-nav__link--active">
      3.HA Proxy OPS
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ha_-_proxy_va_keep_alived_tren_cac_openstack_instance" title="HA - Proxy và Keep Alived trên các Openstack Instance" class="md-nav__link">
    HA - Proxy và Keep Alived trên các Openstack Instance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1_mo_hinh" title="1. Mô hình" class="md-nav__link">
    1. Mô hình
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2_cau_hinh_tren_controller_node" title="2. Cấu hình trên Controller Node" class="md-nav__link">
    2. Cấu hình trên Controller Node
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21_khoi_tao_ip_vip" title="2.1. Khởi tạo IP VIP" class="md-nav__link">
    2.1. Khởi tạo IP VIP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22_binding_ip_vip_cho_cac_port_may_ao" title="2.2. Binding IP VIP cho các port máy ảo" class="md-nav__link">
    2.2. Binding IP VIP cho các port máy ảo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3_cau_hinh_tren_cac_instance" title="3. Cấu hình trên các instance" class="md-nav__link">
    3. Cấu hình trên các instance
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tren_ha1" title="Trên HA1" class="md-nav__link">
    Trên HA1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tren_ha2" title="Trên HA2" class="md-nav__link">
    Trên HA2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tren_ca_2_node_ha" title="Trên cả 2 node HA" class="md-nav__link">
    Trên cả 2 node HA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../4. HAProxy-HTTP&Config/" title="4. HAProxy HTTP&Config" class="md-nav__link">
      4. HAProxy HTTP&Config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../5.  HAproxy-ACL/" title="5.  HAproxy ACL" class="md-nav__link">
      5.  HAproxy ACL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-8-3" type="checkbox" id="nav-2-8-3">
    
    <label class="md-nav__link" for="nav-2-8-3">
      2. Octavia
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="12">
      <label class="md-nav__title" for="nav-2-8-3">
        2. Octavia
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2. Octavia/1.Intro+Setup/" title="1.Intro+Setup" class="md-nav__link">
      1.Intro+Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2. Octavia/2.Use-Octavia/" title="2.Use Octavia" class="md-nav__link">
      2.Use Octavia
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2. Octavia/3. Octavia-Keep-Alived/" title="3. Octavia Keep Alived" class="md-nav__link">
      3. Octavia Keep Alived
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2. Octavia/4 .VIP-QOS/" title="4 .VIP QOS" class="md-nav__link">
      4 .VIP QOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2. Octavia/5.Theory-Octavia-L7-Policy/" title="5.Theory Octavia L7 Policy" class="md-nav__link">
      5.Theory Octavia L7 Policy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2. Octavia/6. LAB-Octavia-L7-Policy/" title="6. LAB Octavia L7 Policy" class="md-nav__link">
      6. LAB Octavia L7 Policy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-8-4" type="checkbox" id="nav-2-8-4">
    
    <label class="md-nav__link" for="nav-2-8-4">
      3. Pacemaker
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="13">
      <label class="md-nav__title" for="nav-2-8-4">
        3. Pacemaker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../3. Pacemaker/1. Intro-Pacemaker/" title="1. Intro Pacemaker" class="md-nav__link">
      1. Intro Pacemaker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../3. Pacemaker/2. Install-Pacemaker/" title="2. Install Pacemaker" class="md-nav__link">
      2. Install Pacemaker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../3. Pacemaker/3. Use-Pacemaker/" title="3. Use Pacemaker" class="md-nav__link">
      3. Use Pacemaker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../3. Pacemaker/4. Pacemaker-Apache-Active-Passive/" title="4. Pacemaker Apache Active Passive" class="md-nav__link">
      4. Pacemaker Apache Active Passive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../3. Pacemaker/corosync/" title="Corosync" class="md-nav__link">
      Corosync
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">
    
    <label class="md-nav__link" for="nav-2-9">
      Horizon
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="10">
      <label class="md-nav__title" for="nav-2-9">
        Horizon
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Horizon/Introduction-horizon/" title="OpenStack Dashboard - Horizon" class="md-nav__link">
      OpenStack Dashboard - Horizon
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      Keystone
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="11">
      <label class="md-nav__title" for="nav-2-10">
        Keystone
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Keystone/1. Introduction-Keystone/" title="1. Openstack Indentify ( Keystone )" class="md-nav__link">
      1. Openstack Indentify ( Keystone )
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Keystone/2.Install-Keystone/" title="Cài đặt và cấu hình Keystone" class="md-nav__link">
      Cài đặt và cấu hình Keystone
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Keystone/3. Architecture-Keystone( additional )/" title="1. Kiến trúc trong Keystone ( bổ sung )" class="md-nav__link">
      1. Kiến trúc trong Keystone ( bổ sung )
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Keystone/4. Config-Keystone/" title="4. Config Keystone" class="md-nav__link">
      4. Config Keystone
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Keystone/5. Keystone-Openstack-CLI/" title="Làm việc với Keystone qua CLI" class="md-nav__link">
      Làm việc với Keystone qua CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Keystone/6. Keystone-CURL/" title="1. Application Credentials" class="md-nav__link">
      1. Application Credentials
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Keystone/7. Token-Keystone/" title="Tìm hiểu Token trong Openstack" class="md-nav__link">
      Tìm hiểu Token trong Openstack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-11" type="checkbox" id="nav-2-11">
    
    <label class="md-nav__link" for="nav-2-11">
      Neutron
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="12">
      <label class="md-nav__title" for="nav-2-11">
        Neutron
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/1. Introduction-neutron/" title="Openstack networking - Neutron" class="md-nav__link">
      Openstack networking - Neutron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/10. OPS-Packet-Provider/" title="10. OPS Packet Provider" class="md-nav__link">
      10. OPS Packet Provider
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/11. VXLAN-Tunnel/" title="11. VXLAN Tunnel" class="md-nav__link">
      11. VXLAN Tunnel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/12. VXLAN-Tunnel-Host-pair-OPS/" title="12. VXLAN Tunnel Host pair OPS" class="md-nav__link">
      12. VXLAN Tunnel Host pair OPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/2. Install Neutron Linux Bridge/" title="Cài đặt Neutron  -- Linux Bridge" class="md-nav__link">
      Cài đặt Neutron  -- Linux Bridge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/2.1 . OVS-Self-Services/" title="2.1 . OVS Self Services" class="md-nav__link">
      2.1 . OVS Self Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/2.2. OVS Self-Service-&-Provider/" title="2.2. OVS Self Service & Provider" class="md-nav__link">
      2.2. OVS Self Service & Provider
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/3. Neutron-CLI/" title="Làm việc với Neutron" class="md-nav__link">
      Làm việc với Neutron
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/4. Neutron-Namespace-Agent/" title="TÌm hiểu Namepsace , DHCP, Agent trong OPS" class="md-nav__link">
      TÌm hiểu Namepsace , DHCP, Agent trong OPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/5.  Packet-Walkthrough-Linux-Bridge/" title="Neutron Traffic Flow trong Linux Bridge" class="md-nav__link">
      Neutron Traffic Flow trong Linux Bridge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/6. Bonding/" title="Tìm hiểu bonding trong Centos" class="md-nav__link">
      Tìm hiểu bonding trong Centos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/7. VXLAN/" title="7. VXLAN" class="md-nav__link">
      7. VXLAN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/8. OpenvSwitch-OPS/" title="Tìm hiểu OVS trong OPS" class="md-nav__link">
      Tìm hiểu OVS trong OPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Neutron/9. OPS-Packet-Self-Service/" title="Tìm hiểu flow packet khi sử dụng OpenvSwitch trong Openstack" class="md-nav__link">
      Tìm hiểu flow packet khi sử dụng OpenvSwitch trong Openstack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-12" type="checkbox" id="nav-2-12">
    
    <label class="md-nav__link" for="nav-2-12">
      Nova
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="13">
      <label class="md-nav__title" for="nav-2-12">
        Nova
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Nova/1.Introduction-nova/" title="1.  Openstack Compute -Nova" class="md-nav__link">
      1.  Openstack Compute -Nova
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Nova/2. Install-nova/" title="Cài đặt Nova - Openstack Compute" class="md-nav__link">
      Cài đặt Nova - Openstack Compute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Nova/3.Nova-Client&Curl/" title="Sử dụng Nova" class="md-nav__link">
      Sử dụng Nova
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Nova/4. Nova-Instance-Work-flow/" title="4. Nova Instance Work flow" class="md-nav__link">
      4. Nova Instance Work flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Nova/5. Debug/" title="5. Debug" class="md-nav__link">
      5. Debug
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Nova/6. Config-section/" title="Một số tùy chọn khác trong nova.conf" class="md-nav__link">
      Một số tùy chọn khác trong nova.conf
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ha_-_proxy_va_keep_alived_tren_cac_openstack_instance" title="HA - Proxy và Keep Alived trên các Openstack Instance" class="md-nav__link">
    HA - Proxy và Keep Alived trên các Openstack Instance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1_mo_hinh" title="1. Mô hình" class="md-nav__link">
    1. Mô hình
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2_cau_hinh_tren_controller_node" title="2. Cấu hình trên Controller Node" class="md-nav__link">
    2. Cấu hình trên Controller Node
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21_khoi_tao_ip_vip" title="2.1. Khởi tạo IP VIP" class="md-nav__link">
    2.1. Khởi tạo IP VIP
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22_binding_ip_vip_cho_cac_port_may_ao" title="2.2. Binding IP VIP cho các port máy ảo" class="md-nav__link">
    2.2. Binding IP VIP cho các port máy ảo
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3_cau_hinh_tren_cac_instance" title="3. Cấu hình trên các instance" class="md-nav__link">
    3. Cấu hình trên các instance
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tren_ha1" title="Trên HA1" class="md-nav__link">
    Trên HA1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tren_ha2" title="Trên HA2" class="md-nav__link">
    Trên HA2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tren_ca_2_node_ha" title="Trên cả 2 node HA" class="md-nav__link">
    Trên cả 2 node HA
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>3.HA Proxy OPS</h1>
                
                <h2 id="ha_-_proxy_va_keep_alived_tren_cac_openstack_instance">HA - Proxy và Keep Alived trên các Openstack Instance<a class="headerlink" href="#ha_-_proxy_va_keep_alived_tren_cac_openstack_instance" title="Permanent link">&para;</a></h2>
<h2 id="1_mo_hinh">1. Mô hình<a class="headerlink" href="#1_mo_hinh" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>VM 1 : Web Server 1 + HA Proxy 1 + Keepalive Master :</p>
<ul>
<li>IP : 192.168.30.148</li>
</ul>
</li>
<li>
<p>VM 2 : Web Server 2 + HA Proxy 2 + Keepalive Backup :</p>
<ul>
<li>IP : 192.168.30.149</li>
</ul>
</li>
</ul>
<h2 id="2_cau_hinh_tren_controller_node">2. Cấu hình trên Controller Node<a class="headerlink" href="#2_cau_hinh_tren_controller_node" title="Permanent link">&para;</a></h2>
<h3 id="21_khoi_tao_ip_vip">2.1. Khởi tạo IP VIP<a class="headerlink" href="#21_khoi_tao_ip_vip" title="Permanent link">&para;</a></h3>
<ul>
<li>Khởi tạo Rule cho giao thức VRRP</li>
</ul>
<pre><code>openstack security group rule create --protocol 112 --ingress --ethertype IPv4 --src-group LB_group LB_group

</code></pre>

<ul>
<li>Liệt kê danh sách network</li>
</ul>
<pre><code>[root@localhost ~]# openstack network list
+--------------------------------------+----------------------------------------------------+--------------------------------------+
| ID                                   | Name                                               | Subnets                              |
+--------------------------------------+----------------------------------------------------+--------------------------------------+
| 672a0c64-2d47-4712-96ff-161fa23ecfed | HA network tenant 438de521107643ee8348114ba022de1b | 2a1c1fa3-fdcf-4079-878e-9dd3bcd9b900 |
| 751cc1ca-c4e4-4623-be31-20c657bcf2c2 | provider                                           | eb785a68-e5f2-4b35-be67-28adfd06c5f4 |
| b98d66ff-2add-496a-a819-cefadcfe69f5 | local                                              | 995891c9-ea38-453d-82cc-e5147ae10353 |
+--------------------------------------+----------------------------------------------------+--------------------------------------+

</code></pre>

<ul>
<li>Khởi tạo một port dành cho IP VIP</li>
</ul>
<pre><code>[root@localhost ~]# neutron port-create provider --fixed-ip ip_address=192.168.30.155
neutron CLI is deprecated and will be removed in the future. Use openstack CLI instead.
Created a new port:
+-----------------------+---------------------------------------------------------------------------------------+
| Field                 | Value                                                                                 |
+-----------------------+---------------------------------------------------------------------------------------+
| admin_state_up        | True                                                                                  |
| allowed_address_pairs |                                                                                       |
| binding:host_id       |                                                                                       |
| binding:profile       | {}                                                                                    |
| binding:vif_details   | {}                                                                                    |
| binding:vif_type      | unbound                                                                               |
| binding:vnic_type     | normal                                                                                |
| created_at            | 2019-01-04T09:25:54Z                                                                  |
| description           |                                                                                       |
| device_id             |                                                                                       |
| device_owner          |                                                                                       |
| extra_dhcp_opts       |                                                                                       |
    | fixed_ips             | {&quot;subnet_id&quot;: &quot;eb785a68-e5f2-4b35-be67-28adfd06c5f4&quot;, &quot;ip_address&quot;: &quot;192.168.30.155&quot;} |
| id                    | 352d23af-df0e-4ee2-8169-5e39fcfc0c0d                                                  |
| mac_address           | fa:16:3e:dd:93:dd                                                                     |
| name                  |                                                                                       |
| network_id            | 751cc1ca-c4e4-4623-be31-20c657bcf2c2                                                  |
| port_security_enabled | True                                                                                  |
| project_id            | 43d21d33e36c4c6097acb1746a50f2b3                                                      |
| qos_policy_id         |                                                                                       |
| revision_number       | 6                                                                                     |
| security_groups       | c3b14f24-ebc1-49b9-924a-1e9cc7f158a1                                                  |
| status                | DOWN                                                                                  |
| tags                  |                                                                                       |
| tenant_id             | 43d21d33e36c4c6097acb1746a50f2b3                                                      |
| updated_at            | 2019-01-04T09:25:55Z                                                                  |
+-----------------------+---------------------------------------------------------------------------------------+

</code></pre>

<h3 id="22_binding_ip_vip_cho_cac_port_may_ao">2.2. Binding IP VIP cho các port máy ảo<a class="headerlink" href="#22_binding_ip_vip_cho_cac_port_may_ao" title="Permanent link">&para;</a></h3>
<ul>
<li>Haproxy cần phải có VIP, đó là một địa chỉ IP bổ sung. Theo mặc định, Neutron sẽ không cho phép một cổng phản hồi các packet nếu nó không được chỉ định </li>
<li>Kiểm tra các máy ảo</li>
</ul>
<pre><code>[root@localhost ~]# nova list
+--------------------------------------+------+--------+------------+-------------+-------------------------+
| ID                                   | Name | Status | Task State | Power State | Networks                |
+--------------------------------------+------+--------+------------+-------------+-------------------------+
| 651b5128-7005-4a63-828d-9dca06adf3e8 | ha1  | ACTIVE | -          | Running     | provider=192.168.30.149 |
| f8ad2a47-e50a-4951-9eaf-327cf589fb0e | ha2  | ACTIVE | -          | Running     | provider=192.168.30.148 |
+--------------------------------------+------+--------+------------+-------------+-------------------------+

</code></pre>

<ul>
<li>Kiểm tra interface trên các máy ảo</li>
</ul>
<pre><code>[root@localhost ~]# nova interface-list ha1
+------------+--------------------------------------+--------------------------------------+----------------+-------------------+
| Port State | Port ID                              | Net ID                               | IP addresses   | MAC Addr          |
+------------+--------------------------------------+--------------------------------------+----------------+-------------------+
| ACTIVE     | 18b4eee8-5d0e-4758-ae3c-1fd4d858a995 | 751cc1ca-c4e4-4623-be31-20c657bcf2c2 | 192.168.30.149 | fa:16:3e:6d:2d:ee |
+------------+--------------------------------------+--------------------------------------+----------------+-------------------+
[root@localhost ~]# nova interface-list ha2
+------------+--------------------------------------+--------------------------------------+----------------+-------------------+
| Port State | Port ID                              | Net ID                               | IP addresses   | MAC Addr          |
+------------+--------------------------------------+--------------------------------------+----------------+-------------------+
| ACTIVE     | 728b0a1e-f1a3-4c3e-9fe0-bfd8cfc3a2a7 | 751cc1ca-c4e4-4623-be31-20c657bcf2c2 | 192.168.30.148 | fa:16:3e:ae:18:ce |
+------------+--------------------------------------+--------------------------------------+----------------+-------------------+
</code></pre>

<ul>
<li>Thêm IP VIP của mỗi port trên trừng máy ảo</li>
</ul>
<pre><code>neutron port-update 18b4eee8-5d0e-4758-ae3c-1fd4d858a995 --allowed_address_pairs list=true type=dict ip_address=192.168.30.155
neutron port-update 728b0a1e-f1a3-4c3e-9fe0-bfd8cfc3a2a7 --allowed_address_pairs list=true type=dict ip_address=192.168.30.155

</code></pre>

<ul>
<li>Kiểm tra IP Pair</li>
</ul>
<pre><code>[root@localhost ~]# openstack port show 728b0a1e-f1a3-4c3e-9fe0-bfd8cfc3a2a7
+-----------------------+-------------------------------------------------------------------------------+
| Field                 | Value                                                                         |
+-----------------------+-------------------------------------------------------------------------------+
| admin_state_up        | UP                                                                            |
| allowed_address_pairs | ip_address='192.168.30.155', mac_address='fa:16:3e:ae:18:ce'                  |
| binding_host_id       | compute1                                                                      |
| binding_profile       |                                                                               |
| binding_vif_details   | datapath_type='system', ovs_hybrid_plug='True', port_filter='True'            |
| binding_vif_type      | ovs                                                                           |
| binding_vnic_type     | normal                                                                        |
| created_at            | 2019-01-04T09:35:49Z                                                          |
| data_plane_status     | None                                                                          |
| description           |                                                                               |
| device_id             | f8ad2a47-e50a-4951-9eaf-327cf589fb0e                                          |
| device_owner          | compute:nova                                                                  |
| dns_assignment        | None                                                                          |
| dns_name              | None                                                                          |
| extra_dhcp_opts       |                                                                               |
| fixed_ips             | ip_address='192.168.30.148', subnet_id='eb785a68-e5f2-4b35-be67-28adfd06c5f4' |
| id                    | 728b0a1e-f1a3-4c3e-9fe0-bfd8cfc3a2a7                                          |
| ip_address            | None                                                                          |
| mac_address           | fa:16:3e:ae:18:ce                                                             |
| name                  |                                                                               |
| network_id            | 751cc1ca-c4e4-4623-be31-20c657bcf2c2                                          |
| option_name           | None                                                                          |
| option_value          | None                                                                          |
| port_security_enabled | True                                                                          |
| project_id            | 438de521107643ee8348114ba022de1b                                              |
| qos_policy_id         | None                                                                          |
| revision_number       | 12                                                                            |
| security_group_ids    | 32c7144d-a976-48d5-a3f1-9eb10114822d                                          |
| status                | ACTIVE                                                                        |
| subnet_id             | None                                                                          |
| tags                  |                                                                               |
| trunk_details         | None                                                                          |
| updated_at            | 2019-01-04T10:31:21Z                                                          |
+-----------------------+-------------------------------------------------------------------------------+

</code></pre>

<h2 id="3_cau_hinh_tren_cac_instance">3. Cấu hình trên các instance<a class="headerlink" href="#3_cau_hinh_tren_cac_instance" title="Permanent link">&para;</a></h2>
<ul>
<li>Cài đặt HA Proxy Keep Alived và Web Server </li>
</ul>
<pre><code>
yum install -y httpd keepalived psmisc haproxy

</code></pre>

<h3 id="tren_ha1"><strong>Trên HA1</strong><a class="headerlink" href="#tren_ha1" title="Permanent link">&para;</a></h3>
<ul>
<li>Cấu hình Keep Alived</li>
</ul>
<pre><code>cat &lt;&lt;EOF &gt; /etc/keepalived/keepalived.conf
vrrp_script chk_haproxy {           # Requires keepalived-1.1.13
        script &quot;killall -0 haproxy&quot;     # cheaper than pidof
        interval 2                      # check every 2 seconds
        weight 2                        # add 2 points of prio if OK
}

vrrp_instance VI_1 {
        interface eth0
        state MASTER
        virtual_router_id 51
        priority 100   # 100 on master, 99 on backup
        virtual_ipaddress {
            192.168.30.155
        }
        unicast_src_ip 192.168.30.148   # IP address of local interface
        unicast_peer {            # IP address of peer interface
        192.168.30.149
        }
        track_script {
            chk_haproxy
        }
}
EOF
</code></pre>

<h3 id="tren_ha2"><strong>Trên HA2</strong><a class="headerlink" href="#tren_ha2" title="Permanent link">&para;</a></h3>
<ul>
<li>Cấu hình Keep Alived</li>
</ul>
<pre><code>cat &lt;&lt;EOF &gt; /etc/keepalived/keepalived.conf
vrrp_script chk_haproxy {           # Requires keepalived-1.1.13
        script &quot;killall -0 haproxy&quot;     # cheaper than pidof
        interval 2                      # check every 2 seconds
        weight 2                        # add 2 points of prio if OK
}

vrrp_instance VI_1 {
        interface eth0
        state BACKUP
        virtual_router_id 51
        priority 99   # 100 on master, 99 on backup
        virtual_ipaddress {
            192.168.30.155
        }
        unicast_src_ip 192.168.30.149   # IP address of local interface
        unicast_peer {            # IP address of peer interface
        192.168.30.148
        }

        track_script {
            chk_haproxy
        }
}
EOF
</code></pre>

<h3 id="tren_ca_2_node_ha"><strong>Trên cả 2 node HA</strong><a class="headerlink" href="#tren_ca_2_node_ha" title="Permanent link">&para;</a></h3>
<ul>
<li>Cấu hình entry front-end  cho HA Proxy</li>
</ul>
<pre><code>frontend  main *:80
    acl url_static       path_beg       -i /static /images /javascript /stylesheets
    acl url_static       path_end       -i .jpg .gif .png .css .js

    stats enable
      # auth info for statistics site
    stats auth admin:adminpassword
      # hide version of HAProxy
    stats hide-version
      # display HAProxy hostname
    stats show-node
      # refresh time
    stats refresh 60s
      # statistics reports' URI
    stats uri /haproxy?stats

    default_backend             app

</code></pre>

<ul>
<li>Cấu hình entry backend cho HA Proxy</li>
</ul>
<pre><code>backend app
    balance     roundrobin
    server  ha2 192.168.30.148:80 check
    server  ha1 192.168.30.149:80 check
</code></pre>

<ul>
<li>Cấu hình nội dung Web Server</li>
</ul>
<pre><code>echo Day la `hostname` &gt; /var/www/html/index.html
</code></pre>

<ul>
<li>Khởi động dich vụ</li>
</ul>
<pre><code>systemctl start keealived haproxy httpd
systemctl enable keealived haproxy httpd

</code></pre>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../2. Setup-HA-Proxy-&&-KeepAlive/" title="2. Setup HA Proxy && KeepAlive" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                2. Setup HA Proxy && KeepAlive
              </span>
            </div>
          </a>
        
        
          <a href="../4. HAProxy-HTTP&Config/" title="4. HAProxy HTTP&Config" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                4. HAProxy HTTP&Config
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            nguyenhungsync
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/application.9e1f3b71.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../.."}})</script>
      
    
    
      
    
  </body>
</html>